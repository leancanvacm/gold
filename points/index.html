<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check-in & Rewards System</title>
    <link href="https://cdn.jsdelivr.net/gh/maketline/goodday/font/stylesheet.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'line_seed_sans_th', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .profile-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .profile-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #667eea;
        }
        
        .profile-info h3 {
            color: #667eea;
            font-size: 18px;
        }
        
        .points-display {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .tab-container {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .tabs {
            display: flex;
            background: #f0f0f0;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
        }
        
        .tab-content {
            padding: 20px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .checkin-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .day-box {
            aspect-ratio: 1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .day-box.checked {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .day-box.today {
            border: 3px solid #667eea;
            background: #f0f0ff;
        }
        
        .day-box.unchecked {
            background: #f5f5f5;
            color: #999;
        }
        
        .day-box .points {
            font-size: 10px;
            margin-top: 2px;
        }
        
        .checkin-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .checkin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        .checkin-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .reward-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .reward-card {
            background: #f8f8f8;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .reward-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .reward-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        
        .reward-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .reward-points {
            color: #667eea;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .reward-stock {
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .exchange-btn {
            padding: 8px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .exchange-btn:hover {
            background: #764ba2;
        }
        
        .exchange-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .admin-tab {
            display: none;
        }
        
        .admin-tab.show {
            display: block;
        }
        
        .pending-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .pending-item {
            background: #f8f8f8;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .approve-btn {
            padding: 8px 15px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #667eea;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .streak-indicator {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            font-size: 14px;
        }
        
        .expire-date {
            font-size: 12px;
            color: #ff6b6b;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="profile-section">
                <img id="profilePic" class="profile-img" src="https://via.placeholder.com/60" alt="Profile">
                <div class="profile-info">
                    <h3 id="displayName">Loading...</h3>
                    <div id="userId" style="font-size: 12px; color: #666;"></div>
                </div>
            </div>
            <div class="points-display">
                üíé ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°: <span id="totalPoints">0</span>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('checkin')">‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô</div>
                <div class="tab" onclick="switchTab('rewards')">‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>
                <div class="tab admin-tab" id="adminTab" onclick="switchTab('admin')">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</div>
            </div>
            
            <div id="checkinTab" class="tab-content active">
                <h4 style="text-align: center; margin-bottom: 15px;">‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h4>
                <div class="streak-indicator" id="streakInfo">
                    üî• Streak: <span id="currentStreak">0</span> ‡∏ß‡∏±‡∏ô
                </div>
                <div class="checkin-grid" id="checkinGrid">
                    <!-- Days will be generated here -->
                </div>
                <button class="checkin-btn" id="checkinBtn" onclick="performCheckin()">
                    ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
                </button>
            </div>
            
            <div id="rewardsTab" class="tab-content">
                <h4 style="text-align: center; margin-bottom: 15px;">‡πÅ‡∏•‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h4>
                <div class="reward-grid" id="rewardGrid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
                    </div>
                </div>
            </div>
            
            <div id="adminTab" class="tab-content">
                <h4 style="text-align: center; margin-bottom: 15px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</h4>
                <div class="pending-list" id="pendingList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxmTQ0knrfzI2puvfueSrjlTFKjA7KzG9aj1H356zyyUAwiCrP0HxkROceSsOVSdNgPHg/exec';
        const LIFF_ID = '1656032875-GLpZe6By';
        
        let userProfile = {};
        let userPoints = 0;
        let currentStreak = 0;
        let todayChecked = false;
        let isAdmin = false;
        
        // Initialize LIFF
        async function initializeLiff() {
            try {
                await liff.init({ liffId: LIFF_ID });
                
                if (!liff.isLoggedIn()) {
                    liff.login();
                    return;
                }
                
                userProfile = await liff.getProfile();
                document.getElementById('profilePic').src = userProfile.pictureUrl;
                document.getElementById('displayName').textContent = userProfile.displayName;
                document.getElementById('userId').textContent = `ID: ${userProfile.userId}`;
                
                // Load user data
                await loadUserData();
                await loadRewards();
                
            } catch (error) {
                console.error('LIFF initialization failed', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö');
            }
        }
        
        // Load user data
        async function loadUserData() {
            try {
                const response = await callGoogleScript({
                    action: 'getUserData',
                    userId: userProfile.userId
                });
                
                if (response.success) {
                    userPoints = response.data.points || 0;
                    currentStreak = response.data.streak || 0;
                    todayChecked = response.data.todayChecked || false;
                    isAdmin = response.data.isAdmin || false;
                    
                    document.getElementById('totalPoints').textContent = userPoints;
                    document.getElementById('currentStreak').textContent = currentStreak;
                    
                    if (isAdmin) {
                        document.getElementById('adminTab').classList.add('show');
                        loadPendingRequests();
                    }
                    
                    updateCheckinGrid();
                    updateCheckinButton();
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }
        
        // Update checkin grid
        function updateCheckinGrid() {
            const grid = document.getElementById('checkinGrid');
            const days = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];
            const today = new Date().getDay();
            
            grid.innerHTML = '';
            
            days.forEach((day, index) => {
                const dayBox = document.createElement('div');
                dayBox.className = 'day-box';
                
                if (index === today) {
                    dayBox.classList.add(todayChecked ? 'checked' : 'today');
                } else if (currentStreak > 0 && index < today && (today - index) <= currentStreak) {
                    dayBox.classList.add('checked');
                } else {
                    dayBox.classList.add('unchecked');
                }
                
                const points = (index === 6 && currentStreak === 6) ? '1.0' : '0.5';
                
                dayBox.innerHTML = `
                    <div>${day}</div>
                    <div class="points">+${points}</div>
                `;
                
                grid.appendChild(dayBox);
            });
        }
        
        // Update checkin button
        function updateCheckinButton() {
            const btn = document.getElementById('checkinBtn');
            if (todayChecked) {
                btn.textContent = '‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ';
                btn.disabled = true;
            }
        }
        
        // Perform checkin
        async function performCheckin() {
            if (todayChecked) return;
            
            try {
                const btn = document.getElementById('checkinBtn');
                btn.disabled = true;
                btn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô...';
                
                const response = await callGoogleScript({
                    action: 'checkin',
                    userId: userProfile.userId,
                    displayName: userProfile.displayName
                });
                
                if (response.success) {
                    todayChecked = true;
                    userPoints = response.data.totalPoints;
                    currentStreak = response.data.streak;
                    
                    document.getElementById('totalPoints').textContent = userPoints;
                    document.getElementById('currentStreak').textContent = currentStreak;
                    
                    updateCheckinGrid();
                    updateCheckinButton();
                    
                    // Send Flex Message
                    if (response.data.flexMessage) {
                        await liff.sendMessages([response.data.flexMessage]);
                    }
                    
                    alert(`‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${response.data.pointsEarned} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
                } else {
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô');
                    btn.disabled = false;
                    btn.textContent = '‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ';
                }
            } catch (error) {
                console.error('Checkin error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô');
            }
        }
        
        // Load rewards
        async function loadRewards() {
            try {
                const response = await callGoogleScript({
                    action: 'getRewards'
                });
                
                if (response.success && response.data) {
                    displayRewards(response.data);
                }
            } catch (error) {
                console.error('Error loading rewards:', error);
            }
        }
        
        // Display rewards
        function displayRewards(rewards) {
            const grid = document.getElementById('rewardGrid');
            grid.innerHTML = '';
            
            rewards.forEach(reward => {
                if (reward.stock > 0 && new Date() <= new Date(reward.expireDate)) {
                    const card = document.createElement('div');
                    card.className = 'reward-card';
                    
                    const canExchange = userPoints >= reward.points;
                    
                    card.innerHTML = `
                        <img src="${reward.image}" alt="${reward.name}" class="reward-img">
                        <div class="reward-name">${reward.name}</div>
                        <div class="reward-points">${reward.points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                        <div class="reward-stock">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${reward.stock}</div>
                        <div class="expire-date">‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ${formatDate(reward.expireDate)}</div>
                        <button class="exchange-btn" 
                                onclick="exchangeReward('${reward.id}', '${reward.name}', ${reward.points})"
                                ${!canExchange ? 'disabled' : ''}>
                            ${canExchange ? '‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•' : '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠'}
                        </button>
                    `;
                    
                    grid.appendChild(card);
                }
            });
        }
        
        // Exchange reward
        async function exchangeReward(rewardId, rewardName, requiredPoints) {
            if (userPoints < requiredPoints) {
                alert('‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠');
                return;
            }
            
            if (!confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å ${rewardName} ‡∏î‡πâ‡∏ß‡∏¢ ${requiredPoints} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                return;
            }
            
            try {
                const response = await callGoogleScript({
                    action: 'exchangeReward',
                    userId: userProfile.userId,
                    displayName: userProfile.displayName,
                    rewardId: rewardId,
                    rewardName: rewardName,
                    points: requiredPoints
                });
                
                if (response.success) {
                    userPoints = response.data.remainingPoints;
                    document.getElementById('totalPoints').textContent = userPoints;
                    
                    alert('‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô');
                    await loadRewards();
                } else {
                    alert(response.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•');
                }
            } catch (error) {
                console.error('Exchange error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•');
            }
        }
        
        // Load pending requests (Admin)
        async function loadPendingRequests() {
            if (!isAdmin) return;
            
            try {
                const response = await callGoogleScript({
                    action: 'getPendingRequests'
                });
                
                if (response.success && response.data) {
                    displayPendingRequests(response.data);
                }
            } catch (error) {
                console.error('Error loading pending requests:', error);
            }
        }
        
        // Display pending requests
        function displayPendingRequests(requests) {
            const list = document.getElementById('pendingList');
            list.innerHTML = '';
            
            if (requests.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</p>';
                return;
            }
            
            requests.forEach(request => {
                const item = document.createElement('div');
                item.className = 'pending-item';
                
                item.innerHTML = `
                    <div>
                        <div style="font-weight: bold;">${request.displayName}</div>
                        <div style="font-size: 14px; color: #666;">${request.rewardName}</div>
                        <div style="font-size: 12px; color: #999;">${formatDate(request.timestamp)}</div>
                    </div>
                    <button class="approve-btn" onclick="approveRequest('${request.id}')">
                        ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                    </button>
                `;
                
                list.appendChild(item);
            });
        }
        
        // Approve request
        async function approveRequest(requestId) {
            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ô‡∏µ‡πâ?')) return;
            
            try {
                const response = await callGoogleScript({
                    action: 'approveRequest',
                    requestId: requestId
                });
                
                if (response.success) {
                    alert('‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    await loadPendingRequests();
                } else {
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥');
                }
            } catch (error) {
                console.error('Approve error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥');
            }
        }
        
        // Switch tab
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            if (tabName === 'admin' && isAdmin) {
                loadPendingRequests();
            }
        }
        
        // Call Google Script via JSONP
        function callGoogleScript(data) {
            return new Promise((resolve, reject) => {
                const callbackName = 'callback_' + Math.random().toString(36).substring(7);
                const script = document.createElement('script');
                
                window[callbackName] = function(response) {
                    delete window[callbackName];
                    document.body.removeChild(script);
                    resolve(response);
                };
                
                const params = new URLSearchParams({
                    ...data,
                    callback: callbackName
                });
                
                script.src = `${SCRIPT_URL}?${params}`;
                script.onerror = () => {
                    delete window[callbackName];
                    document.body.removeChild(script);
                    reject(new Error('Script loading failed'));
                };
                
                document.body.appendChild(script);
            });
        }
        
        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('th-TH', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        // Initialize on load
        window.onload = function() {
            initializeLiff();
        };
    </script>
</body>
</html>
